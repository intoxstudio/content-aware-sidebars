/*!
 * @package Content Aware Sidebars
 * @author Joachim Jensen <joachim@dev.institute>
 * @license GPLv3
 * @copyright 2019 by Joachim Jensen
 */
!function($){"use strict";var e={$sidebarContainer:$(".widget-liquid-right"),$widgetContainer:$("#available-widgets"),init:function(){this.openSidebarByURL(),this.addSidebarToolbar(),this.addWidgetSearch(),this.enhancedWidgetManager()},openSidebarByURL:function(){if(window.location.hash){var e=this.$sidebarContainer.find(".widgets-holder-wrap"),i=e.has(window.location.hash);i.length&&i.add(e.first()).find(".handlediv,.sidebar-name-arrow").trigger("click")}},enhancedWidgetManager:function(){if($("body").hasClass("cas-widget-manager")){this.$widgetContainer.find(".widget").draggable("option","scroll",!1);var i=this,a=$("#widgets-left .inactive-sidebar");a.toggle(this.$widgetContainer.hasClass("closed")),this.$widgetContainer.find(".sidebar-name").click(function(e){a.toggle(i.$widgetContainer.hasClass("closed"))})}},addWidgetSearch:function(){var e=$(".widget",this.$widgetContainer).get().reverse();$(".sidebar-description",this.$widgetContainer).prepend('<input type="search" class="js-cas-widget-filter cas-filter" placeholder="'+CASAdmin.filterWidgets+'...">'),this.searchWidgetListener(e)},searchWidgetListener:function(i){var a,s="";this.$widgetContainer.on("input",".js-cas-widget-filter",function(e){var t=$(this).val();t!=s&&(s=t,a&&clearTimeout(a),a=setTimeout(function(){$(i).each(function(e,i){var a=$(i);a.find(".widget-title :nth-child(1)").text().search(new RegExp(t,"i"))<0?a.fadeOut():(a.prependTo(a.parent()),a.fadeIn().css("display",""))})},250))})},addSidebarToolbar:function(){var e='<div class="wp-filter cas-filter-sidebar"><a href="admin.php?page=wpcas-edit" class="button button-primary">'+CASAdmin.addNew+'</a><div class="sidebars-toggle"><a href="#" title="'+CASAdmin.collapse+'" class="js-sidebars-toggle" data-toggle="0"><span class="dashicons dashicons-arrow-up-alt2"></span></a><a href="#" title="'+CASAdmin.expand+'" class="js-sidebars-toggle" data-toggle="1"><span class="dashicons dashicons-arrow-down-alt2"></span></a></div><input type="search" class="js-cas-filter cas-filter" placeholder="'+CASAdmin.filterSidebars+'..."></div>';this.$sidebarContainer.prepend(e),this.searchSidebarListener(),this.addSidebarToggle()},addSidebarToggle:function(){var a=$(document),t=this.$sidebarContainer.find(".widgets-holder-wrap");$("body").on("click",".js-sidebars-toggle",function(e){e.preventDefault();var i=!!$(this).data("toggle");t.toggleClass("closed",!i),i&&t.children(".widgets-sortables").sortable("refresh"),a.triggerHandler("wp-pin-menu")})},searchSidebarListener:function(){var i,a=this,s="";this.$sidebarContainer.on("input",".js-cas-filter",function(e){var t=$(this).val();t!=s&&(s=t,i&&clearTimeout(i),i=setTimeout(function(){$(".widgets-holder-wrap",a.$sidebarContainer).each(function(e,i){var a=$(i);a.find(".sidebar-name :nth-child(2)").text().search(new RegExp(t,"i"))<0?a.fadeOut():a.fadeIn()})},250))})}};$(document).ready(function(){e.init()})}(jQuery);